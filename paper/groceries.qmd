---
title: "are grocery prices attainable"
subtitle: "Analysing grocery prices with inflation and wages"
author: Cristina Burca
thanks: "Code and data are available at: [Are Groxeries Attainable](https://github.com/Mezhi18/US_Election2024.git)."
date: today
date-format: long
abstract: "We analyse the probability of Kamala Harris winning in the 7 swing states of USA using baysian modeling;the states we look at are Arizona, Michigan, Pennsylvania, Nevada, Georgia, Wisconsin and North Carolina. USA is a large country with its national economy affecting the global economic conditions, which is why predicting the future President of USA will help understand the future economic condiotion of the world. Through baysian modelling we found that North Carolina (47.26% support for Harris), Nevada(46.43% support for Harris), Wisconsin(48.38% support for Harris), Michigan(47.30% support for Harris), Pennsylvania(48.02% support for Harris) will vote Kamala Harris, while the rest of the swing states might vote Donald Trump, meaning that majority of the swing states will vote Kamala Harris. Provided this we predict that Kamala Harris will win the election. By creating a baysian model based on 'polls of polls'  where we compare the results from different polls, we are able to make this prediction."
format:
  pdf:
    bibliography: references.bib
    documentclass: article
    geometry: margin = 1in
number-sections: true
toc: true
bibliography: references.bib
---

# Introduction

Inflation in Cananda has increased rampantly in all sectors, growing concerns about affordability. Within this, the roles of inflation and stagnant wages have made groceries less attainable for Canadians. Grocery prices have risen 22.5% since May of 2020, and continue to rise each month 


"How have grocery prices in Canada changed over time, and how do these changes, relative to inflation and wages, affect the accessibility of a healthy diet across socioeconomic classes?"

"How do grocery store pricing strategies influence the affordability of healthy diets in Canada, and how have these strategies changed over time in relation to inflation and wages?"

Focus on a subset of comparable products (e.g., fruits vs. snacks, vegetables vs. processed foods).
 Analyze how prices for healthy and unhealthy groceries have changed over time.


-eggs
-butter
-milk
- chicken
- rice 
- potatoes
- tomatoes
- 

# Data

```{r}
#| include: false
#| message: false
#| warning: false

library(tidyverse)

grocery_data <- read.csv("../data/02-analysis_data/grocery_data.csv")
inflation_data <- read.csv("../data/02-analysis_data/inflation_data.csv")
avg_wage_data <- read.csv("../data/02-analysis_data/avg_wage_data.csv")
inflation_wage_data <- read.csv("../data/02-analysis_data/inflation_wage_data.csv")
```


```{r}


```


```{r}
grocery_data <- grocery_data %>%
  mutate(Date = as.Date(paste(year, month, "01", sep = "-"))) # Assuming "01" for the day
grocery_data
# Plot the data ordered by Date
ggplot(grocery_data, aes(x = Date, y = Toothpaste._100_millilitres_5)) +
  geom_line(color = "blue", size = 1) +  # Add a line plot
  labs(
    title = "Toothpaste",
    x = "Date",
    y = "Price (per kilogram)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


```{r}
ggplot(avg_wage_data, aes(x = year, y = Wage)) +
  geom_line(color = "blue", size = 1) +  # Line plot
  geom_point(color = "red", size = 2) +  # Points on the line
  labs(
    title = "Year vs Wage",
    x = "Year",
    y = "Wage (in Dollars)"
  ) +
  theme_minimal()  # Use a clean theme

```

```{r}
library(ggplot2)
library(dplyr)
library(tidyr)

# Step 1: Normalize the variables for comparison
grocery_data <- grocery_data %>%
  mutate(
    Stewing_Cuts_Normalized = (Toothpaste._100_millilitres_5 - min(Toothpaste._100_millilitres_5)) /
                              (max(Toothpaste._100_millilitres_5) - min(Toothpaste._100_millilitres_5)),
    CPI_Normalized = (CPI - min(CPI)) / (max(CPI) - min(CPI))
  )

# Step 2: Reshape the data to long format
grocery_data_long <- grocery_data %>%
  pivot_longer(
    cols = c(Stewing_Cuts_Normalized, CPI_Normalized), # Add variables to compare
    names_to = "Variable",
    values_to = "Value"
  )

# Step 3: Plot both variables on the same y-axis
ggplot(grocery_data_long, aes(x = Date, y = Value, color = Variable, group = Variable)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Comparison of Beef Stewing Cuts Price and CPI Over Time",
    x = "Date",
    y = "Normalized Value (0 to 1)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
# Step 1: Normalize the variables for comparison
grocery_data <- grocery_data %>%
  mutate(
    Stewing_Cuts_Normalized = (Toothpaste._100_millilitres_5 - min(Toothpaste._100_millilitres_5)) /
                              (max(Toothpaste._100_millilitres_5) - min(Toothpaste._100_millilitres_5)),
    CPI_Normalized = (CPI - min(CPI)) / (max(CPI) - min(CPI))
  )

# Step 2: Reshape the data to long format
grocery_data_long <- grocery_data %>%
  pivot_longer(
    cols = c(Stewing_Cuts_Normalized, CPI_Normalized), # Add variables to compare
    names_to = "Variable",
    values_to = "Value"
  )

# Step 3: Plot both variables on the same y-axis
ggplot(grocery_data_long, aes(x = Date, y = Value, color = Variable, group = Variable)) +
  geom_line(size = 1) +
  geom_point(size = 2) +
  labs(
    title = "Comparison of Beef Stewing Cuts Price and CPI Over Time",
    x = "Date",
    y = "Normalized Value (0 to 1)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


```{r}
library(dplyr)
library(ggplot2)

# Assuming `CPI_Percentage` is the inflation rate in percentage (e.g., 0.02 for 2%)
# Step 1: Create the inflation-adjusted price column
grocery_data <- grocery_data %>%
  mutate(
    Inflation_Rate = (CPI - lag(CPI, default = first(CPI))) / lag(CPI, default = first(CPI)), # Calculate monthly inflation
    Inflation_Rate = replace_na(Inflation_Rate, 0), # Handle any NA values
    Adjusted_Beef_Price = Toothpaste._100_millilitres_5 *
                          cumprod(1 + Inflation_Rate) # Cumulatively apply inflation
  )

# Step 2: Plot both the original and adjusted prices
ggplot(grocery_data, aes(x = Date)) +
  geom_line(aes(y = Toothpaste._100_millilitres_5, color = "Original Beef Price"), size = 1) +
  geom_line(aes(y = Adjusted_Beef_Price, color = "Inflation-Adjusted Price"), size = 1, linetype = "dashed") +
  labs(
    title = "Beef Stewing Cuts Price vs Inflation-Adjusted Price",
    x = "Date",
    y = "Price (per kilogram)",
    color = "Legend"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


# Discussion

## Limitations
- 